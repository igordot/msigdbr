<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Tidy eval helpers — tidyeval • msigdbr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Tidy eval helpers — tidyeval"><meta property="og:description" content="This page lists the tidy eval tools reexported in this package from
rlang. To learn about using tidy eval in scripts and packages at a
high level, see the dplyr programming vignette
and the ggplot2 in packages vignette.
The Metaprogramming section of Advanced R may also be useful for a deeper dive.
The tidy eval operators {{, !!, and !!! are syntactic
constructs which are specially interpreted by tidy eval functions.
You will mostly need {{, as !! and !!! are more advanced
operators which you should not have to use in simple cases.
The curly-curly operator {{ allows you to tunnel data-variables
passed from function arguments inside other tidy eval functions.
{{ is designed for individual arguments. To pass multiple
arguments contained in dots, use ... in the normal way.
my_function &amp;lt;- function(data, var, ...) {
  data %&amp;gt;%
    group_by(...) %&amp;gt;%
    summarise(mean = mean({{ var }}))
}

enquo() and enquos() delay the execution of one or several
function arguments. The former returns a single expression, the
latter returns a list of expressions. Once defused, expressions
will no longer evaluate on their own. They must be injected back
into an evaluation context with !! (for a single expression) and
!!! (for a list of expressions).
my_function &amp;lt;- function(data, var, ...) {
  # Defuse
  var &amp;lt;- enquo(var)
  dots &amp;lt;- enquos(...)

  # Inject
  data %&amp;gt;%
    group_by(!!!dots) %&amp;gt;%
    summarise(mean = mean(!!var))
}

In this simple case, the code is equivalent to the usage of {{
and ... above. Defusing with enquo() or enquos() is only
needed in more complex cases, for instance if you need to inspect
or modify the expressions in some way.
The .data pronoun is an object that represents the current
slice of data. If you have a variable name in a string, use the
.data pronoun to subset that variable with [[.
my_var &amp;lt;- &quot;disp&quot;
mtcars %&amp;gt;% summarise(mean = mean(.data[[my_var]]))

Another tidy eval operator is :=. It makes it possible to use
glue and curly-curly syntax on the LHS of =. For technical
reasons, the R language doesn't support complex expressions on
the left of =, so we use := as a workaround.
my_function &amp;lt;- function(data, var, suffix = &quot;foo&quot;) {
  # Use `{{` to tunnel function arguments and the usual glue
  # operator `{` to interpolate plain strings.
  data %&amp;gt;%
    summarise(&quot;{{ var }}_mean_{suffix}&quot; := mean({{ var }}))
}

Many tidy eval functions like dplyr::mutate() or
dplyr::summarise() give an automatic name to unnamed inputs. If
you need to create the same sort of automatic names by yourself,
use as_label(). For instance, the glue-tunnelling syntax above
can be reproduced manually with:
my_function &amp;lt;- function(data, var, suffix = &quot;foo&quot;) {
  var &amp;lt;- enquo(var)
  prefix &amp;lt;- as_label(var)
  data %&amp;gt;%
    summarise(&quot;{prefix}_mean_{suffix}&quot; := mean(!!var))
}

Expressions defused with enquo() (or tunnelled with {{) need
not be simple column names, they can be arbitrarily complex.
as_label() handles those cases gracefully. If your code assumes
a simple column name, use as_name() instead. This is safer
because it throws an error if the input is not a name as expected.

"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@bioigor"><meta name="twitter:site" content="@bioigor"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-130263433-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-130263433-2');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msigdbr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">7.5.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../articles/msigdbr-intro.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/igordot/msigdbr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tidy eval helpers</h1>
    <small class="dont-index">Source: <a href="https://github.com/igordot/msigdbr/blob/HEAD/R/utils-tidy-eval.R" class="external-link"><code>R/utils-tidy-eval.R</code></a></small>
    <div class="hidden name"><code>tidyeval.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This page lists the tidy eval tools reexported in this package from
rlang. To learn about using tidy eval in scripts and packages at a
high level, see the <a href="https://dplyr.tidyverse.org/articles/programming.html" class="external-link">dplyr programming vignette</a>
and the <a href="https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html" class="external-link">ggplot2 in packages vignette</a>.
The <a href="https://adv-r.hadley.nz/metaprogramming.html" class="external-link">Metaprogramming section</a> of <a href="https://adv-r.hadley.nz" class="external-link">Advanced R</a> may also be useful for a deeper dive.</p><ul><li><p>The tidy eval operators <code>{{</code>, <code>!!</code>, and <code>!!!</code> are syntactic
constructs which are specially interpreted by tidy eval functions.
You will mostly need <code>{{</code>, as <code>!!</code> and <code>!!!</code> are more advanced
operators which you should not have to use in simple cases.</p>
<p>The curly-curly operator <code>{{</code> allows you to tunnel data-variables
passed from function arguments inside other tidy eval functions.
<code>{{</code> is designed for individual arguments. To pass multiple
arguments contained in dots, use <code>...</code> in the normal way.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1"></a>my_function &lt;-<span class="st"> </span><span class="cf">function</span>(data, var, ...) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>  data <span class="op">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="st">    </span><span class="kw">group_by</span>(...) <span class="op">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>({{ var }}))</span>
<span id="cb1-5"><a href="#cb1-5"></a>}</span></code></pre><p></p></div></li>
<li><p><code>enquo()</code> and <code>enquos()</code> delay the execution of one or several
function arguments. The former returns a single expression, the
latter returns a list of expressions. Once defused, expressions
will no longer evaluate on their own. They must be injected back
into an evaluation context with <code>!!</code> (for a single expression) and
<code>!!!</code> (for a list of expressions).</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1"></a>my_function &lt;-<span class="st"> </span><span class="cf">function</span>(data, var, ...) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="co"># Defuse</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  var &lt;-<span class="st"> </span><span class="kw">enquo</span>(var)</span>
<span id="cb1-4"><a href="#cb1-4"></a>  dots &lt;-<span class="st"> </span><span class="kw">enquos</span>(...)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="co"># Inject</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  data <span class="op">%&gt;%</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="st">    </span><span class="kw">group_by</span>(<span class="op">!!!</span>dots) <span class="op">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(<span class="op">!!</span>var))</span>
<span id="cb1-10"><a href="#cb1-10"></a>}</span></code></pre><p></p></div>
<p>In this simple case, the code is equivalent to the usage of <code>{{</code>
and <code>...</code> above. Defusing with <code>enquo()</code> or <code>enquos()</code> is only
needed in more complex cases, for instance if you need to inspect
or modify the expressions in some way.</p></li>
<li><p>The <code>.data</code> pronoun is an object that represents the current
slice of data. If you have a variable name in a string, use the
<code>.data</code> pronoun to subset that variable with <code>[[</code>.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1"></a>my_var &lt;-<span class="st"> "disp"</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(.data[[my_var]]))</span></code></pre><p></p></div></li>
<li><p>Another tidy eval operator is <code>:=</code>. It makes it possible to use
glue and curly-curly syntax on the LHS of <code>=</code>. For technical
reasons, the R language doesn't support complex expressions on
the left of <code>=</code>, so we use <code>:=</code> as a workaround.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1"></a>my_function &lt;-<span class="st"> </span><span class="cf">function</span>(data, var, <span class="dt">suffix =</span> <span class="st">"foo"</span>) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="co"># Use `{{` to tunnel function arguments and the usual glue</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="co"># operator `{` to interpolate plain strings.</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>  data <span class="op">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="st">"{{ var }}_mean_{suffix}"</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">mean</span>({{ var }}))</span>
<span id="cb1-6"><a href="#cb1-6"></a>}</span></code></pre><p></p></div></li>
<li><p>Many tidy eval functions like <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> or
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarise()</a></code> give an automatic name to unnamed inputs. If
you need to create the same sort of automatic names by yourself,
use <code>as_label()</code>. For instance, the glue-tunnelling syntax above
can be reproduced manually with:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1"></a>my_function &lt;-<span class="st"> </span><span class="cf">function</span>(data, var, <span class="dt">suffix =</span> <span class="st">"foo"</span>) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>  var &lt;-<span class="st"> </span><span class="kw">enquo</span>(var)</span>
<span id="cb1-3"><a href="#cb1-3"></a>  prefix &lt;-<span class="st"> </span><span class="kw">as_label</span>(var)</span>
<span id="cb1-4"><a href="#cb1-4"></a>  data <span class="op">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="st">"{prefix}_mean_{suffix}"</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">mean</span>(<span class="op">!!</span>var))</span>
<span id="cb1-6"><a href="#cb1-6"></a>}</span></code></pre><p></p></div>
<p>Expressions defused with <code>enquo()</code> (or tunnelled with <code>{{</code>) need
not be simple column names, they can be arbitrarily complex.
<code>as_label()</code> handles those cases gracefully. If your code assumes
a simple column name, use <code>as_name()</code> instead. This is safer
because it throws an error if the input is not a name as expected.</p></li>
</ul></div>



  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Igor Dolgalev.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

